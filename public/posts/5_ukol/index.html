<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>5. Úkol | ZPC-Jak vytvořit (téměř) cokoliv</title>
<meta name="title" content="5. Úkol" />
<meta name="description" content="
  Elektronický obvod s mikrokontrolérem
  
  V rámci miniprojektu z elektrotechniky jsem vytvořil jednoduchý MP3 přehrávač s Arduinem Uno a bzučákem. Projekt přehrává pět známých melodií: 
   The Godfather, Star Wars, Tetris, Cantina Band a Harry Potter. 
  Vše je zapojeno přes breadboard, který propojuje tři tlačítka a pět LED diod pro signalizaci.
  
  Ovládání
  
    Tlačítko 1 – přehrát / pozastavit aktuální písničku,
    Tlačítko 2 – přepnout na další skladbu,
    Tlačítko 3 – přepnout na předchozí skladbu.
  
  
  K Arduino Unu je připojeno pět modrých LED diod (piny 5–9) s odpory o hodnotě 510 Ω (zelená, hnědá, červená, zlatá), 
  které ukazují, která písnička je právě zvolena.
  " />
<meta name="keywords" content="Arduino,Elektro," />


<meta property="og:url" content="https://267993-spec.github.io/267993_ZPC_25/posts/5_ukol/">
  <meta property="og:site_name" content="ZPC-Jak vytvořit (téměř) cokoliv">
  <meta property="og:title" content="5. Úkol">
  <meta property="og:description" content="Elektronický obvod s mikrokontrolérem V rámci miniprojektu z elektrotechniky jsem vytvořil jednoduchý MP3 přehrávač s Arduinem Uno a bzučákem. Projekt přehrává pět známých melodií: The Godfather, Star Wars, Tetris, Cantina Band a Harry Potter. Vše je zapojeno přes breadboard, který propojuje tři tlačítka a pět LED diod pro signalizaci. Ovládání Tlačítko 1 – přehrát / pozastavit aktuální písničku, Tlačítko 2 – přepnout na další skladbu, Tlačítko 3 – přepnout na předchozí skladbu. K Arduino Unu je připojeno pět modrých LED diod (piny 5–9) s odpory o hodnotě 510 Ω (zelená, hnědá, červená, zlatá), které ukazují, která písnička je právě zvolena.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-22T20:24:11+02:00">
    <meta property="article:modified_time" content="2025-09-22T20:24:11+02:00">
    <meta property="article:tag" content="Arduino">
    <meta property="article:tag" content="Elektro">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="5. Úkol">
  <meta name="twitter:description" content="Elektronický obvod s mikrokontrolérem V rámci miniprojektu z elektrotechniky jsem vytvořil jednoduchý MP3 přehrávač s Arduinem Uno a bzučákem. Projekt přehrává pět známých melodií: The Godfather, Star Wars, Tetris, Cantina Band a Harry Potter. Vše je zapojeno přes breadboard, který propojuje tři tlačítka a pět LED diod pro signalizaci. Ovládání Tlačítko 1 – přehrát / pozastavit aktuální písničku, Tlačítko 2 – přepnout na další skladbu, Tlačítko 3 – přepnout na předchozí skladbu. K Arduino Unu je připojeno pět modrých LED diod (piny 5–9) s odpory o hodnotě 510 Ω (zelená, hnědá, červená, zlatá), které ukazují, která písnička je právě zvolena.">




  <meta itemprop="name" content="5. Úkol">
  <meta itemprop="description" content="Elektronický obvod s mikrokontrolérem V rámci miniprojektu z elektrotechniky jsem vytvořil jednoduchý MP3 přehrávač s Arduinem Uno a bzučákem. Projekt přehrává pět známých melodií: The Godfather, Star Wars, Tetris, Cantina Band a Harry Potter. Vše je zapojeno přes breadboard, který propojuje tři tlačítka a pět LED diod pro signalizaci. Ovládání Tlačítko 1 – přehrát / pozastavit aktuální písničku, Tlačítko 2 – přepnout na další skladbu, Tlačítko 3 – přepnout na předchozí skladbu. K Arduino Unu je připojeno pět modrých LED diod (piny 5–9) s odpory o hodnotě 510 Ω (zelená, hnědá, červená, zlatá), které ukazují, která písnička je právě zvolena.">
  <meta itemprop="datePublished" content="2025-09-22T20:24:11+02:00">
  <meta itemprop="dateModified" content="2025-09-22T20:24:11+02:00">
  <meta itemprop="wordCount" content="1820">
  <meta itemprop="keywords" content="Arduino,Elektro">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  :root {
    --width: 720px;
    --font-main: Verdana, sans-serif;
    --font-secondary: Verdana, sans-serif;
    --font-scale: 1em;
    --background-color: #fff;
    --heading-color: #222;
    --text-color: #444;
    --link-color: #3273dc;
    --visited-color: #8b6fcb;
    --blockquote-color: #222;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --background-color: #01242e;
      --heading-color: #eee;
      --text-color: #ddd;
      --link-color: #8cc2dd;
      --visited-color: #8b6fcb;
      --blockquote-color: #ccc;
    }
  }

  body {
    font-family: var(--font-secondary);
    font-size: var(--font-scale);
    margin: auto;
    padding: 20px;
    max-width: var(--width);
    text-align: left;
    background-color: var(--background-color);
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: var(--text-color);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-main);
    color: var(--heading-color);
  }

  a {
    color: var(--link-color);
    cursor: pointer;
    text-decoration: none;
  }

  a:hover {
    text-decoration: underline;
  }

  nav a {
    margin-right: 8px;
  }

  strong,
  b {
    color: var(--heading-color);
  }

  button {
    margin: 0;
    cursor: pointer;
  }

  time {
    font-family: monospace;
    font-style: normal;
    font-size: 15px;
  }

  main {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  hr {
    border: 0;
    border-top: 1px dashed;
  }

  img {
    max-width: 100%;
  }

  code {
    font-family: monospace;
    padding: 2px;
    border-radius: 3px;
  }

  blockquote {
    border-left: 1px solid #999;
    color: var(--blockquote-color);
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px 0;
    text-align: center;
  }

  .title:hover {
    text-decoration: none;
  }

  .title h1 {
    font-size: 1.5em;
  }

  .inline {
    width: auto !important;
  }

  .highlight,
  .code {
    border-radius: 3px;
    margin-block-start: 1em;
    margin-block-end: 1em;
    overflow-x: auto;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: var(--visited-color);
  }

</style>

</head>

<body>
  <header><a href="/267993_ZPC_25/" class="title">
  <h2>ZPC-Jak vytvořit (téměř) cokoliv</h2>
</a>
<nav>
<a href="https://267993-spec.github.io/267993_ZPC_25/">Domů</a>

<a href="/267993_ZPC_25/posts/o_mne/">O mně</a>

<a href="/267993_ZPC_25/posts/individualni_projekt/">Individální projekt</a>

</nav>
</header>
  <main>

<content>
  <div style="max-width: 900px; margin: 0 auto; text-align: justify;">
  <h2 style="font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem; color: #ffffff;">Elektronický obvod s mikrokontrolérem</h2>
  <p>
  V rámci miniprojektu z elektrotechniky jsem vytvořil jednoduchý <strong>MP3 přehrávač s Arduinem Uno</strong> a bzučákem. Projekt přehrává pět známých melodií: 
   <em>The Godfather</em>, <em>Star Wars</em>, <em>Tetris</em>, <em>Cantina Band</em> a <em>Harry Potter</em>. 
  Vše je zapojeno přes <strong>breadboard</strong>, který propojuje tři tlačítka a pět LED diod pro signalizaci.
  </p>
  <h2>Ovládání</h2>
  <ul>
    <li><strong>Tlačítko 1</strong> – přehrát / pozastavit aktuální písničku,</li>
    <li><strong>Tlačítko 2</strong> – přepnout na další skladbu,</li>
    <li><strong>Tlačítko 3</strong> – přepnout na předchozí skladbu.</li>
  </ul>
  <p>
  K Arduino Unu je připojeno <strong>pět modrých LED diod</strong> (piny 5–9) s odpory o hodnotě <strong>510 Ω</strong> (<em>zelená, hnědá, červená, zlatá</em>), 
  které ukazují, která písnička je právě zvolena.
  </p>
  <h2>Popis programu</h2>
  <p>
  Kód byl napsán v prostředí <strong>Arduino IDE</strong> v jazyce C++. Program využívá pole, ve kterých jsou uloženy jednotlivé melodie a jejich délky. 
  Pomocí funkce <code>tone()</code> se na bzučáku (v mém případě pin 11) generují tóny o různé frekvenci. 
  Každá melodie je přehrávána v cyklu a uživatel může pomocí tlačítek přepínat mezi skladbami nebo přehrávání pozastavit.
  </p>
  <p>
  Program využívá princip neblokujícího přehrávání – každá nota má svůj čas trvání a Arduino během toho stále reaguje na stisk tlačítek. 
  LEDky se rozsvítí podle vybrané písničky a funkce <code>nastavitLEDky()</code> zajistí, že vždy svítí pouze ta správná.
  </p>
  <h2>Popis logických funkcí a podmínek v Arduino kódu</h2>
  <p>
  Tento program ovládá jednoduchý MP3 přehrávač založený na Arduinu. Pomocí tří tlačítek, pěti LED diod a bzučáku umožňuje přehrávat různé melodie. 
  Kód je napsán tak, aby běžel neblokujícím způsobem – používá časovač <code>millis()</code> místo <code>delay()</code>, takže může reagovat na stisk tlačítek i během přehrávání.
  </p>
  <h3>Hlavní proměnné</h3>
  <pre><code>const int bzučák = 11;
const int tlacitkoDalsi = 3;
const int tlacitkoPredchozi = 4;
const int tlacitkoPrehrat = 2;
const int ledky[5] = {5, 6, 7, 8, 9};</code></pre>
  <p>
  Piny jsou nastaveny tak, aby tlačítka fungovala s interním pull-up rezistorem (<code>INPUT_PULLUP</code>), 
  takže logická nula (LOW) znamená stisk.
  </p>
  <h3>Funkce <code>delkaNoty()</code></h3>
  <pre><code>if (hodnota > 0) return celaNota / hodnota;
else return celaNota / abs(hodnota) * 1.5;</code></pre>
  <ul>
    <li>Pokud je hodnota kladná, jde o běžnou notu.</li>
    <li>Pokud je záporná, jedná se o tečkovanou notu (prodlouženou o polovinu).</li>
  </ul>
  <h3>Funkce <code>nastavitLEDky()</code></h3>
  <pre><code>for (int i = 0; i < 5; i++) {
  digitalWrite(ledky[i], i == aktualniPisnicka ? HIGH : LOW);
}</code></pre>
  <p>Ternární operátor <code>? :</code> zajišťuje, že svítí právě ta LED, která odpovídá aktuální skladbě.</p>
  <h3>Funkce <code>prehratNotu()</code></h3>
  <pre><code>if (aktualniNota >= delka) aktualniNota = 0;
if (ted - casZacatkuNoty >= trvani) {
  aktualniNota++;
  casZacatkuNoty = ted;
  if (melodie[aktualniNota] == PAUZA) noTone(bzučák);
  else tone(bzučák, melodie[aktualniNota]);
}</code></pre>
  <ul>
    <li>První <code>if</code> zajišťuje návrat na začátek po konci melodie.</li>
    <li>Druhý sleduje, zda uplynul čas noty – pokud ano, posune se na další.</li>
    <li>Vnořený <code>if</code> vypne tón při pauze nebo přehraje další frekvenci.</li>
  </ul>
  <h3>Reakce na tlačítka</h3>
  <h4>Play / Pause</h4>
  <pre><code>if (posledniPrehrat == HIGH && prehratNow == LOW)
  prehravaSe = !prehravaSe;</code></pre>
  <h4>Další písnička</h4>
  <pre><code>if (posledniDalsi == HIGH && dalsiNow == LOW) {
  aktualniPisnicka = (aktualniPisnicka + 1) % 5;
  aktualniNota = 0;
  nastavitLEDky();
}</code></pre>
  <h4>Předchozí písnička</h4>
  <pre><code>if (posledniPredchozi == HIGH && predchoziNow == LOW) {
  aktualniPisnicka = (aktualniPisnicka == 0) ? 4 : aktualniPisnicka - 1;
  aktualniNota = 0;
  nastavitLEDky();
}</code></pre>
  <h4>Přehrávání / Pauza</h4>
  <pre><code>if (prehravaSe) prehratNotu();
else noTone(bzučák);</code></pre>
  <h3>Souhrn logických funkcí</h3>
  <table style="width:100%; border-collapse:collapse; text-align:left;" border="1" cellpadding="5">
    <tr><th>Podmínka / Funkce</th><th>Účel</th><th>Popis logiky</th></tr>
    <tr><td><code>if (hodnota > 0)</code></td><td>Délka noty</td><td>Rozlišuje běžnou a tečkovanou notu</td></tr>
    <tr><td><code>if (aktualniNota >= delka)</code></td><td>Přehrávání</td><td>Vrací se na začátek melodie</td></tr>
    <tr><td><code>if (ted - casZacatkuNoty >= trvani)</code></td><td>Časování not</td><td>Určuje, kdy přejít na další tón</td></tr>
    <tr><td><code>if (melodie[aktualniNota] == PAUZA)</code></td><td>Zvuk</td><td>Přehraje ticho místo tónu</td></tr>
    <tr><td><code>if (posledniPrehrat == HIGH && prehratNow == LOW)</code></td><td>Tlačítko PLAY</td><td>Přepínání přehrávání / pauzy</td></tr>
    <tr><td><code>if (posledniDalsi == HIGH && dalsiNow == LOW)</code></td><td>Tlačítko NEXT</td><td>Přechod na další skladbu</td></tr>
    <tr><td><code>if (posledniPredchozi == HIGH && predchoziNow == LOW)</code></td><td>Tlačítko BACK</td><td>Přechod na předchozí skladbu</td></tr>
    <tr><td><code>if (prehravaSe)</code></td><td>Hlavní stav</td><td>Rozhoduje, zda se přehrává, nebo ne</td></tr>
  </table>
<div style="text-align: center; margin-top: 2rem;">
    <div style="display: inline-block; margin: 10px;">
      <img src="/267993_ZPC_25/images/OBVOD.png" alt="Náhled obvodu v Tinkercadu" style="width: 100%; max-width: 600px; border-radius: 10px;">
      <p style="transform: skewX(-10deg);">Obr. 1 Sestava MP3 obvodu z vrchu (kondenzátor je jako bružák)</p>
    </div>
  <div style="text-align: center; margin-top: 2rem;">
    <div style="display: inline-block; margin: 10px;">
      <img src="/267993_ZPC_25/images/Obvod1.jpg" alt="Náhled obvodu" style="width: 100%; max-width: 600px; border-radius: 10px;">
      <p style="transform: skewX(-10deg);">Obr. 2 Sestava MP3 obvodu z vrchu</p>
    </div>
<div style="display: inline-block; margin: 10px;">
      <img src="/267993_ZPC_25/images/Obvod2.jpg" alt="Pohled zepředu" style="width: 100%; max-width: 600px; border-radius: 10px;">
      <p style="transform: skewX(-10deg);">Obr. 3 MP3 obvod zepředu</p>
    </div>
<div style="display: inline-block; margin: 10px;">
      <video controls muted style="width: 100%; max-width: 600px; border-radius: 10px;">
        <source src="/267993_ZPC_25/videos/VideoObvodu.mp4" type="video/mp4">
        Váš prohlížeč nepodporuje přehrávání videa.
      </video>
      <p style="transform: skewX(-10deg);">Video 1 Ukázka funkčnosti MP3 obvodu</p>
    </div>
  </div>
</div>
<div style="max-width: 800px; margin: 2rem auto; text-align:left;">
  
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark-dimmed.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  
  <style>
  .code-window {
    background: #1e1e1e;
    border-radius: 12px;
    overflow: hidden;
    margin: 1.5rem 0;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    font-family: 'Fira Code', monospace;
  }
  .code-header {
    background: #2d2d2d;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .dot { width: 12px; height: 12px; border-radius: 50%; }
  .red { background: #ff5f56; } .yellow { background: #ffbd2e; } .green { background: #27c93f; }
  .code-content { padding: 1rem; overflow-x: auto; }
  </style>
  
  <div class="code-window">
    <div class="code-header">
      <span class="dot red"></span>
      <span class="dot yellow"></span>
      <span class="dot green"></span>
      <span style="color:#ccc; margin-left:10px;">Miniprojekt.ino</span>
    </div>
    <div class="code-content">
      <pre><code class="language-cpp">#include "pitches.h"
  #define REST 0
  
  const int bzučák = 11;
  const int tlacitkoDalsi = 3;
  const int tlacitkoPredchozi = 4;
  const int tlacitkoPrehrat = 2;
  const int ledky[5] = {5, 6, 7, 8, 9};
  
  // ------------ PÍSNIČKY -------------
  int melodie1[] = {REST, REST, REST, NOTE_E4, NOTE_A4, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_B4, NOTE_A4, NOTE_F4, NOTE_G4, NOTE_E4, NOTE_E4, NOTE_A4, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_E4, NOTE_DS4, NOTE_D4, NOTE_D4, NOTE_F4, NOTE_GS4, NOTE_B4, NOTE_D4, NOTE_F4, NOTE_GS4, NOTE_A4, NOTE_C4, NOTE_C4, NOTE_G4, NOTE_F4, NOTE_E4, NOTE_G4, NOTE_F4, NOTE_F4, NOTE_E4, NOTE_E4, NOTE_GS4, NOTE_A4, REST, NOTE_A4, NOTE_A4, NOTE_GS4, NOTE_G4, NOTE_B4, NOTE_A4, NOTE_F4, NOTE_E4, NOTE_E4, NOTE_G4, NOTE_E4, NOTE_D4, NOTE_D4, NOTE_D4, NOTE_F4, NOTE_DS4, NOTE_E4, REST, NOTE_E4, NOTE_A4, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_B4, NOTE_A4, NOTE_F4, NOTE_G4, NOTE_E4, NOTE_E4, NOTE_A4, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_E4, NOTE_DS4, NOTE_D4, NOTE_D4, NOTE_F4, NOTE_GS4, NOTE_B4, NOTE_D4, NOTE_F4, NOTE_GS4, NOTE_A4, NOTE_C4, NOTE_C4, NOTE_G4, NOTE_F4, NOTE_E4, NOTE_G4, NOTE_F4, NOTE_F4, NOTE_E4, NOTE_E4, NOTE_GS4, NOTE_A4, REST, NOTE_A4, NOTE_A4, NOTE_GS4, NOTE_G4, NOTE_B4, NOTE_A4, NOTE_F4, NOTE_E4, NOTE_E4, NOTE_G4, NOTE_E4, NOTE_D4, NOTE_D4, NOTE_D4, NOTE_F4, NOTE_DS4, NOTE_E4};
  int delky1[] = {4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 2, 8, 8, 8, 8, 2};
  
  int melodie2[] = {NOTE_E5, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_A4, NOTE_C5, NOTE_E5, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_E5, NOTE_C5, NOTE_A4, NOTE_A4, REST, REST, NOTE_D5, NOTE_F5, NOTE_A5, NOTE_G5, NOTE_F5, NOTE_E5, NOTE_C5, NOTE_E5, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_E5, NOTE_C5, NOTE_A4, NOTE_A4, REST, NOTE_E5, NOTE_C5, NOTE_D5, NOTE_B4, NOTE_C5, NOTE_A4, NOTE_B4, NOTE_E5, NOTE_C5, NOTE_D5, NOTE_B4, NOTE_C5, NOTE_E5, NOTE_A5, NOTE_GS5, NOTE_E5, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_A4, NOTE_C5, NOTE_E5, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_E5, NOTE_C5, NOTE_A4, NOTE_A4, REST, REST, NOTE_D5, NOTE_F5, NOTE_A5, NOTE_G5, NOTE_F5, REST, NOTE_E5, NOTE_C5, NOTE_E5, NOTE_D5, NOTE_C5, REST, NOTE_B4, NOTE_C5, NOTE_D5, NOTE_E5, REST, NOTE_C5, NOTE_A4, NOTE_A4, REST};
  int delky2[] = {4, 8, 8, 4, 8, 8, 4, 8, 8, 4, 8, 8, -4, 8, 4, 4, 4, 4, 4, 4, 8, 4, 8, 4, 8, 8, -4, 8, 4, 8, 8, 4, 8, 8, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 4, 4, 2, 1, 4, 8, 8, 4, 8, 8, 4, 8, 8, 4, 8, 8, -4, 8, 4, 4, 4, 4, 4, 4, 8, 4, 8, 4, 8, 8, 8, 4, 8, 4, 8, 8, 8, 4, 8, 4, 4, 8, 4, 8, 4, 4};
  
  int melodie3[] = {REST, NOTE_D4, NOTE_G4, NOTE_AS4, NOTE_A4, NOTE_G4, NOTE_D5, NOTE_C5, NOTE_A4, NOTE_G4, NOTE_AS4, NOTE_A4, NOTE_F4, NOTE_GS4, NOTE_D4, NOTE_D4, NOTE_G4, NOTE_AS4, NOTE_A4, NOTE_G4, NOTE_D5, NOTE_F5, NOTE_E5, NOTE_DS5, NOTE_B4, NOTE_DS5, NOTE_D5, NOTE_CS5, NOTE_CS4, NOTE_B4, NOTE_G4, NOTE_AS4, NOTE_D5, NOTE_AS4, NOTE_D5, NOTE_AS4, NOTE_DS5, NOTE_D5, NOTE_CS5, NOTE_A4, NOTE_AS4, NOTE_D5, NOTE_CS5, NOTE_CS4, NOTE_D4, NOTE_D5, REST, NOTE_AS4, NOTE_D5, NOTE_AS4, NOTE_D5, NOTE_AS4, NOTE_F5, NOTE_E5, NOTE_DS5, NOTE_B4, NOTE_DS5, NOTE_D5, NOTE_CS5, NOTE_CS4, NOTE_AS4, NOTE_G4};
  int delky3[] = {2, 4, -4, 8, 4, 2, 4, -2, -2, -4, 8, 4, 2, 4, -1, 4, -4, 8, 4, 2, 4, 2, 4, 2, 4, -4, 8, 4, 2, 4, -1, 4, 2, 4, 2, 4, 2, 4, 2, 4, -4, 8, 4, 2, 4, -1, 4, 4, 2, 4, 2, 4, 2, 4, -4, 8, 4, 2, 4, -1};
  
  int melodie4[] = {NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_F4, REST, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_F4, REST, NOTE_A4, NOTE_A4, NOTE_A4, NOTE_F4, NOTE_C5, NOTE_A4, NOTE_F4, NOTE_C5, NOTE_A4, NOTE_E5, NOTE_E5, NOTE_E5, NOTE_F5, NOTE_C5, NOTE_A4, NOTE_F4, NOTE_C5, NOTE_A4, NOTE_A5, NOTE_A4, NOTE_A4, NOTE_A5, NOTE_GS5, NOTE_G5, NOTE_DS5, NOTE_D5, NOTE_DS5, REST, NOTE_A4, NOTE_DS5, NOTE_D5, NOTE_CS5, NOTE_C5, NOTE_B4, NOTE_C5, REST, NOTE_F4, NOTE_GS4, NOTE_F4, NOTE_A4, NOTE_C5, NOTE_A4, NOTE_C5, NOTE_E5, NOTE_A5, NOTE_A4, NOTE_A4, NOTE_A5, NOTE_GS5, NOTE_G5, NOTE_DS5, NOTE_D5, NOTE_DS5, REST, NOTE_A4, NOTE_DS5, NOTE_D5, NOTE_CS5, NOTE_C5, NOTE_B4, NOTE_C5, REST, NOTE_F4, NOTE_GS4, NOTE_F4, NOTE_A4, NOTE_A4, NOTE_F4, NOTE_C5, NOTE_A4};
  int delky4[] = {-4, -4, 16, 16, 16, 16, 8, 8, -4, -4, 16, 16, 16, 16, 8, 8, 4, 4, 4, -8, 16, 4, -8, 16, 2, 4, 4, 4, -8, 16, 4, -8, 16, 2, 4, -8, 16, 4, -8, 16, 16, 16, 16, 8, 8, 8, 4, -8, 16, 4, -8, 16, 2, 4, -8, 16, 4, -8, 16, 16, 16, 16, 8, 8, 8, 4, -8, 16, 4, -8, 16, 2};
  
  int melodie5[] = {NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, REST, NOTE_AS4, NOTE_B4, NOTE_B4, NOTE_AS4, NOTE_B4, NOTE_A4, REST, NOTE_GS4, NOTE_A4, NOTE_G4, NOTE_G4, NOTE_E4, NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, REST, NOTE_AS4, NOTE_B4, NOTE_A4, NOTE_A4, NOTE_GS4, NOTE_A4, NOTE_D5, NOTE_C5, NOTE_B4, NOTE_A4, NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, NOTE_E5, NOTE_B4, REST, NOTE_AS4, NOTE_B4, NOTE_D5, NOTE_D5, NOTE_B4, NOTE_A4, NOTE_G4, NOTE_E4, NOTE_E4, NOTE_G4, NOTE_B4, NOTE_D5, NOTE_F5, NOTE_E5, NOTE_AS4, NOTE_AS4, NOTE_B4, NOTE_G4};
  int delky5[] = {-4, -4, -4, -4, 8, -4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, -2, -4, -4, -4, -4, 8, -4, 8, 8, 8, 8, -4, -4, 8, -4, 8, -4, -4, -4, -4, -4, -4, -4, -4, 8, -4, 8, 8, 8, 8, 4, -4, 8, -4, -4, -2, 2, 2, 2, 2, -4, -4, 8, 8, 4, 4};
  
  
  int* vsechnyMelodie[] = {melodie1, melodie2, melodie3, melodie4, melodie5};
  int* vsechnyDelky[] = {delky1, delky2, delky3, delky4, delky5};
  int delkyMelodii[] = {
    sizeof(melodie1)/sizeof(int),
    sizeof(melodie2)/sizeof(int),
    sizeof(melodie3)/sizeof(int),
    sizeof(melodie4)/sizeof(int),
    sizeof(melodie5)/sizeof(int)
  };
  
  // ---------- STAV ----------
  int aktualniPisnicka = 0;
  bool prehravaSe = false;
  int aktualniNota = 0;
  unsigned long casZacatkuNoty = 0;
  
  bool posledniPrehrat = HIGH;
  bool posledniDalsi = HIGH;
  bool posledniPredchozi = HIGH;
  
  int tempo = 120;
  
  // ---------- FUNKCE ----------
  int delkaNoty(int hodnota){
    int celaNota = (60000 * 4) / tempo;
    if (hodnota > 0) return celaNota / hodnota;
    else return celaNota / abs(hodnota) * 1.5;
  }
  
  void nastavitLEDky(){
    for(int i = 0; i < 5; i++){
      digitalWrite(ledky[i], i == aktualniPisnicka ? HIGH : LOW);
    }
  }
  
  void prehratNotu(){
    int* melodie = vsechnyMelodie[aktualniPisnicka];
    int* delky = vsechnyDelky[aktualniPisnicka];
    int delka = delkyMelodii[aktualniPisnicka];
  
    if(aktualniNota >= delka) aktualniNota = 0;
  
    unsigned long ted = millis();
    int trvani = delkaNoty(delky[aktualniNota]);
  
    if(ted - casZacatkuNoty >= trvani){
      aktualniNota++;
      casZacatkuNoty = ted;
      if(aktualniNota < delka){
        if(melodie[aktualniNota] == PAUZA) noTone(bzučák);
        else tone(bzučák, melodie[aktualniNota]);
      }
    }
  }
  
  void setup() {
    pinMode(bzučák, OUTPUT);
    pinMode(tlacitkoDalsi, INPUT_PULLUP);
    pinMode(tlacitkoPredchozi, INPUT_PULLUP);
    pinMode(tlacitkoPrehrat, INPUT_PULLUP);
    for(int i = 0; i < 5; i++) pinMode(ledky[i], OUTPUT);
    nastavitLEDky();
  }
  
  void loop() {
    bool prehratNow = digitalRead(tlacitkoPrehrat);
    bool dalsiNow = digitalRead(tlacitkoDalsi);
    bool predchoziNow = digitalRead(tlacitkoPredchozi);
  
    if(posledniPrehrat == HIGH && prehratNow == LOW) prehravaSe = !prehravaSe;
    posledniPrehrat = prehratNow;
  
    if(posledniDalsi == HIGH && dalsiNow == LOW){
      aktualniPisnicka = (aktualniPisnicka + 1) % 5;
      aktualniNota = 0;
      nastavitLEDky();
    }
    posledniDalsi = dalsiNow;
  
    if(posledniPredchozi == HIGH && predchoziNow == LOW){
      aktualniPisnicka = (aktualniPisnicka == 0) ? 4 : aktualniPisnicka - 1;
      aktualniNota = 0;
      nastavitLEDky();
    }
    posledniPredchozi = predchoziNow;
  
    if(prehravaSe) prehratNotu();
    else noTone(bzučák);
  }</code></pre>
    </div>
  </div>

</div>

</content>



<p>
  
  <a href="https://267993-spec.github.io/267993_ZPC_25/tags/arduino/">#Arduino</a>
  
  <a href="https://267993-spec.github.io/267993_ZPC_25/tags/elektro/">#Elektro</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

  
</body>

</html>
